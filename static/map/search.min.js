!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.search=t():e.search=t()}(window,(function(){return function(e){var t=window.webpackHotUpdate_name_;window.webpackHotUpdate_name_=function(e,r){!function(e,t){if(!S[e]||!P[e])return;for(var r in P[e]=!1,t)Object.prototype.hasOwnProperty.call(t,r)&&(f[r]=t[r]);0==--m&&0===v&&w()}(e,r),t&&t(e,r)};var r,o=!0,i="c2e198bf77ed96839d8a",n={},a=[],s=[];function c(e){var t=b[e];if(!t)return C;var o=function(o){return t.hot.active?(b[o]?-1===b[o].parents.indexOf(e)&&b[o].parents.push(e):(a=[e],r=o),-1===t.children.indexOf(o)&&t.children.push(o)):(console.warn("[HMR] unexpected require("+o+") from disposed module "+e),a=[]),C(o)},i=function(e){return{configurable:!0,enumerable:!0,get:function(){return C[e]},set:function(t){C[e]=t}}};for(var n in C)Object.prototype.hasOwnProperty.call(C,n)&&"e"!==n&&"t"!==n&&Object.defineProperty(o,n,i(n));return o.e=function(e){return"ready"===h&&u("prepare"),v++,C.e(e).then(t,(function(e){throw t(),e}));function t(){v--,"prepare"===h&&(_[e]||O(e),0===v&&0===m&&w())}},o.t=function(e,t){return 1&t&&(e=o(e)),C.t(e,-2&t)},o}function p(t){var o={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:r!==t,active:!0,accept:function(e,t){if(void 0===e)o._selfAccepted=!0;else if("function"==typeof e)o._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)o._acceptedDependencies[e[r]]=t||function(){};else o._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)o._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)o._declinedDependencies[e[t]]=!0;else o._declinedDependencies[e]=!0},dispose:function(e){o._disposeHandlers.push(e)},addDisposeHandler:function(e){o._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=o._disposeHandlers.indexOf(e);t>=0&&o._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,h){case"idle":(f={})[t]=e[t],u("ready");break;case"ready":L(t);break;case"prepare":case"check":case"dispose":case"apply":(g=g||[]).push(t)}},check:B,apply:I,status:function(e){if(!e)return h;l.push(e)},addStatusHandler:function(e){l.push(e)},removeStatusHandler:function(e){var t=l.indexOf(e);t>=0&&l.splice(t,1)},data:n[t]};return r=void 0,o}var l=[],h="idle";function u(e){h=e;for(var t=0;t<l.length;t++)l[t].call(null,e)}var d,f,y,g,m=0,v=0,_={},P={},S={};function k(e){return+e+""===e?+e:e}function B(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return o=e,u("check"),(t=1e4,t=t||1e4,new Promise((function(e,r){if("undefined"==typeof XMLHttpRequest)return r(new Error("No browser support"));try{var o=new XMLHttpRequest,n=C.p+""+i+".hot-update.json";o.open("GET",n,!0),o.timeout=t,o.send(null)}catch(e){return r(e)}o.onreadystatechange=function(){if(4===o.readyState)if(0===o.status)r(new Error("Manifest request to "+n+" timed out."));else if(404===o.status)e();else if(200!==o.status&&304!==o.status)r(new Error("Manifest request to "+n+" failed."));else{try{var t=JSON.parse(o.responseText)}catch(e){return void r(e)}e(t)}}}))).then((function(e){if(!e)return u(M()?"ready":"idle"),null;P={},_={},S=e.c,y=e.h,u("prepare");var t=new Promise((function(e,t){d={resolve:e,reject:t}}));f={};return O(10),"prepare"===h&&0===v&&0===m&&w(),t}));var t}function O(e){S[e]?(P[e]=!0,m++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=C.p+""+e+"."+i+".hot-update.js",document.head.appendChild(t)}(e)):_[e]=!0}function w(){u("ready");var e=d;if(d=null,e)if(o)Promise.resolve().then((function(){return I(o)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var r in f)Object.prototype.hasOwnProperty.call(f,r)&&t.push(k(r));e.resolve(t)}}function I(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");return function t(o){var s,c,p,l,h;function d(e){for(var t=[e],r={},o=t.map((function(e){return{chain:[e],id:e}}));o.length>0;){var i=o.pop(),n=i.id,a=i.chain;if((l=b[n])&&(!l.hot._selfAccepted||l.hot._selfInvalidated)){if(l.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:n};if(l.hot._main)return{type:"unaccepted",chain:a,moduleId:n};for(var s=0;s<l.parents.length;s++){var c=l.parents[s],p=b[c];if(p){if(p.hot._declinedDependencies[n])return{type:"declined",chain:a.concat([c]),moduleId:n,parentId:c};-1===t.indexOf(c)&&(p.hot._acceptedDependencies[n]?(r[c]||(r[c]=[]),m(r[c],[n])):(delete r[c],t.push(c),o.push({chain:a.concat([c]),id:c})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:r}}function m(e,t){for(var r=0;r<t.length;r++){var o=t[r];-1===e.indexOf(o)&&e.push(o)}}M();var v={},_=[],P={},B=function(){console.warn("[HMR] unexpected require("+w.moduleId+") to disposed module")};for(var O in f)if(Object.prototype.hasOwnProperty.call(f,O)){var w;h=k(O),w=f[O]?d(h):{type:"disposed",moduleId:O};var I=!1,L=!1,E=!1,F="";switch(w.chain&&(F="\nUpdate propagation: "+w.chain.join(" -> ")),w.type){case"self-declined":o.onDeclined&&o.onDeclined(w),o.ignoreDeclined||(I=new Error("Aborted because of self decline: "+w.moduleId+F));break;case"declined":o.onDeclined&&o.onDeclined(w),o.ignoreDeclined||(I=new Error("Aborted because of declined dependency: "+w.moduleId+" in "+w.parentId+F));break;case"unaccepted":o.onUnaccepted&&o.onUnaccepted(w),o.ignoreUnaccepted||(I=new Error("Aborted because "+h+" is not accepted"+F));break;case"accepted":o.onAccepted&&o.onAccepted(w),L=!0;break;case"disposed":o.onDisposed&&o.onDisposed(w),E=!0;break;default:throw new Error("Unexception type "+w.type)}if(I)return u("abort"),Promise.reject(I);if(L)for(h in P[h]=f[h],m(_,w.outdatedModules),w.outdatedDependencies)Object.prototype.hasOwnProperty.call(w.outdatedDependencies,h)&&(v[h]||(v[h]=[]),m(v[h],w.outdatedDependencies[h]));E&&(m(_,[w.moduleId]),P[h]=B)}var x,j=[];for(c=0;c<_.length;c++)h=_[c],b[h]&&b[h].hot._selfAccepted&&P[h]!==B&&!b[h].hot._selfInvalidated&&j.push({module:h,parents:b[h].parents.slice(),errorHandler:b[h].hot._selfAccepted});u("dispose"),Object.keys(S).forEach((function(e){!1===S[e]&&function(e){delete installedChunks[e]}(e)}));var T,H,D=_.slice();for(;D.length>0;)if(h=D.pop(),l=b[h]){var A={},N=l.hot._disposeHandlers;for(p=0;p<N.length;p++)(s=N[p])(A);for(n[h]=A,l.hot.active=!1,delete b[h],delete v[h],p=0;p<l.children.length;p++){var U=b[l.children[p]];U&&((x=U.parents.indexOf(h))>=0&&U.parents.splice(x,1))}}for(h in v)if(Object.prototype.hasOwnProperty.call(v,h)&&(l=b[h]))for(H=v[h],p=0;p<H.length;p++)T=H[p],(x=l.children.indexOf(T))>=0&&l.children.splice(x,1);u("apply"),void 0!==y&&(i=y,y=void 0);for(h in f=void 0,P)Object.prototype.hasOwnProperty.call(P,h)&&(e[h]=P[h]);var R=null;for(h in v)if(Object.prototype.hasOwnProperty.call(v,h)&&(l=b[h])){H=v[h];var G=[];for(c=0;c<H.length;c++)if(T=H[c],s=l.hot._acceptedDependencies[T]){if(-1!==G.indexOf(s))continue;G.push(s)}for(c=0;c<G.length;c++){s=G[c];try{s(H)}catch(e){o.onErrored&&o.onErrored({type:"accept-errored",moduleId:h,dependencyId:H[c],error:e}),o.ignoreErrored||R||(R=e)}}}for(c=0;c<j.length;c++){var V=j[c];h=V.module,a=V.parents,r=h;try{C(h)}catch(e){if("function"==typeof V.errorHandler)try{V.errorHandler(e)}catch(t){o.onErrored&&o.onErrored({type:"self-accept-error-handler-errored",moduleId:h,error:t,originalError:e}),o.ignoreErrored||R||(R=t),R||(R=e)}else o.onErrored&&o.onErrored({type:"self-accept-errored",moduleId:h,error:e}),o.ignoreErrored||R||(R=e)}}if(R)return u("fail"),Promise.reject(R);if(g)return t(o).then((function(e){return _.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e}));return u("idle"),new Promise((function(e){e(_)}))}(t=t||{})}function M(){if(g)return f||(f={}),g.forEach(L),g=void 0,!0}function L(t){Object.prototype.hasOwnProperty.call(f,t)||(f[t]=e[t])}var b={};function C(t){if(b[t])return b[t].exports;var r=b[t]={i:t,l:!1,exports:{},hot:p(t),parents:(s=a,a=[],s),children:[]};return e[t].call(r.exports,r,r.exports,c(t)),r.l=!0,r.exports}return C.m=e,C.c=b,C.d=function(e,t,r){C.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},C.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},C.t=function(e,t){if(1&t&&(e=C(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(C.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)C.d(r,o,function(t){return e[t]}.bind(null,o));return r},C.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return C.d(t,"a",t),t},C.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},C.p="",C.h=function(){return i},c("Ozvm")(C.s="Ozvm")}({"4mlF":function(e,t){},EoQN:function(e,t,r){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.SpatialSearch=void 0;var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="",t.params={},t}return i(t,e),t.prototype.init=function(t,r){e.prototype.initBase.call(this,r),this.type=t},t.prototype.search=function(e,t,r){var o=this;if(!e.mapExtent){var i=this.map.getExtent();e.mapExtent=i.xmin+","+i.ymin+","+i.xmax+","+i.ymax}e.imageDisplay&&(e.imageDisplay=window.screen.width+","+window.screen.height+",96"),this.params=e;var n=map.Factory.deepCopy(e);map.Factory.SearchData("SpatialData",(function(e){e.search(o.type,n,(function(e){o.handlePromiseResult(e,t,r)}),(function(e){r&&r()}))}))},t.prototype.handlePage=function(e,t,r){switch(this.type){case"arcgis":this.handleArcPage(e,t,r);break;case"geoserver":this.handleGeoPage(e,t,r)}},t.prototype.showFeatures=function(){this.pageList.length>0&&e.prototype.showFeaturesBase.call(this,this.pageList)},t.prototype.clear=function(){e.prototype.clearBase.call(this)},t.prototype.localByBounds=function(){if(this.pageList&&1===this.pageList.length){if(!this.pageList[0].geometry)return;e.prototype.localByBoundsBase.call(this,this.pageList[0])}else if(this.pageList&&this.pageList.length>1){var t=[];this.pageList.forEach((function(e){e.geometry&&("Point"===e.geometry.type?t.push(e.geometry.coordinates):map.Factory.Utils("TurfUtils",(function(r){t.push(r.turfCenterOfMass(e).geometry.coordinates)})))})),t.length>0&&e.prototype.localByBoundsBase.call(this,t)}},t.prototype.localByCenter=function(t,r){var o=this;"Point"===t.geometry.type?e.prototype.localByCenterBase.call(this,t.geometry.coordinates,r):map.Factory.Utils("TurfUtils",(function(i){e.prototype.localByCenterBase.call(o,i.turfCenterOfMass(t).geometry.coordinates,r)}))},t.prototype.highlight=function(t){e.prototype.highlightMarkerBase.call(this,t)},t.prototype.clearHighlightMarker=function(){e.prototype.clearHighlightMarkerBase.call(this)},t.prototype.info=function(t,r){e.prototype.popupBase.call(this,t,r)},t}(r("NyFr").CommonSearchService);t.SpatialSearch=n},"FTm/":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hat=void 0;var o=function(){function e(){}return e.hat=function(e,t){if(t||(t=16),void 0===e&&(e=128),e<=0)return"0";for(var r=Math.log(Math.pow(2,e))/Math.log(t),o=2;r===1/0;o*=2)r=Math.log(Math.pow(2,e/o))/Math.log(t)*o;var i=r-Math.floor(r),n="";for(o=0;o<Math.floor(r);o++){n=Math.floor(Math.random()*t).toString(t)+n}if(i){var a=Math.pow(t,i);n=Math.floor(Math.random()*a).toString(t)+n}var s=parseInt(n,t);return s!==1/0&&s>=Math.pow(2,e)?this.hat(e,t):n},e}();t.Hat=o},Glxv:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageService=void 0;var o=function(){function e(){this.datas=[],this.pageList=[],this.pageSize=10,this.pageIndex=1,this.pageCount=1,this.rowsCount=0}return e.prototype.setPageSize=function(e){this.pageSize=e},e.prototype.reset=function(){this.datas=[],this.pageList=[],this.rowsCount=0,this.pageSize=10,this.pageIndex=1,this.pageCount=1},e.prototype.resetData=function(){this.datas=[],this.pageList=[],this.rowsCount=0,this.pageCount=1},e.prototype.initPages=function(){var e=this.pageList.length;e<0&&(e=0);var t=this.pageSize,r=e/t;r%t!=0&&r++,this.pageCount=Math.floor(r),this.rowsCount=e},e.prototype.prePage=function(){var e=this.pageIndex;--e<=0&&(e=1),this.setPageIndex(e)},e.prototype.nextPage=function(){var e=this.pageIndex,t=this.pageCount;++e>t&&(e=t),this.setPageIndex(e)},e.prototype.firstPage=function(){this.setPageIndex(1)},e.prototype.lastPage=function(){var e=this.pageCount;this.setPageIndex(e)},e.prototype.setPageIndex=function(e){this.pageIndex=e,this.rowsCount<=0?this.pageList=[]:this.loadPage()},e.prototype.loadPage=function(){var e=this.pageSize,t=this.pageIndex*e,r=t-e;r>this.rowsCount-1||(t>this.rowsCount&&(t=this.rowsCount),this.handlePage(this.datas,r,t))},e.prototype.handlePage=function(e,t,r){},e}();t.PageService=o},HCmN:function(e,t,r){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeSearch=void 0;var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="",t.params={},t.searchLineSourceId="LINE-ATTRIBUTE-SEARCH",t.searchFillSourceId="FILL-ATTRIBUTE-SEARCH",t.searchLineLayerId="line-attribute-search-layer",t.searchFillLayerId="fill-attribute-search-layer",t.clickLineSourceId="LINE-ATTRIBUTE-CLICK",t.clickFillSourceId="FILL-ATTRIBUTE-CLICK",t.clickLineLayerId="line-attribute-click-layer",t.clickFillLayerId="fill-attribute-click-layer",t}return i(t,e),t.prototype.init=function(t,r){e.prototype.initBase.call(this,r),this.type=t},t.prototype.search=function(e,t,r){var o=this;this.params=e,this.params.inExtent&&(this.params.extent=this.params.extent?this.params.extent:this.map.getExtent());var i=map.Factory.deepCopy(e);map.Factory.SearchData("AttributeData",(function(e){e.search(o.type,i,(function(e){o.handlePromiseResult(e,t,r)}),(function(e){r&&r()}))}))},t.prototype.handlePage=function(e,t,r){switch(this.type){case"arcgis":this.handleArcPage(e,t,r);break;case"geoserver":this.handleGeoPage(e,t,r)}},t.prototype.showFeatures=function(){this.pageList.length>0&&e.prototype.showFeaturesBase.call(this,this.pageList)},t.prototype.clear=function(){e.prototype.clearBase.call(this)},t.prototype.localByBounds=function(){if(this.pageList&&1===this.pageList.length){if(!this.pageList[0].geometry)return;"Point"===this.pageList[0].geometry.type?e.prototype.localByCenterBase.call(this,this.pageList[0].geometry.coordinates):e.prototype.localByBoundsBase.call(this,this.pageList[0])}else if(this.pageList&&this.pageList.length>1){var t=[];this.pageList.forEach((function(e){e.geometry&&("Point"===e.geometry.type?t.push(e.geometry.coordinates):map.Factory.Utils("TurfUtils",(function(r){t.push(r.turfCenterOfMass(e).geometry.coordinates)})))})),t.length>0&&e.prototype.localByBoundsBase.call(this,t)}},t.prototype.localByCenter=function(t,r){var o=this;"Point"===t.geometry.type?e.prototype.localByCenterBase.call(this,t.geometry.coordinates,r):map.Factory.Utils("TurfUtils",(function(i){e.prototype.localByCenterBase.call(o,i.turfCenterOfMass(t).geometry.coordinates,r)}))},t.prototype.highlight=function(t){e.prototype.highlightMarkerBase.call(this,t)},t.prototype.lineHighlight=function(t,r){e.prototype.lineHighlightBase.call(this,t,r)},t.prototype.searchLineAndFillHighlight=function(t,r){"fill"===r?e.prototype.SearchToFillHighlightBase.call(this,t,this.searchFillSourceId,this.searchFillLayerId):"line"===r&&e.prototype.SearchToLineHighlightBase.call(this,t,this.searchLineSourceId,this.searchLineLayerId)},t.prototype.clickLineAndFillHighlight=function(t,r){"fill"===r?e.prototype.SearchToFillHighlightBase.call(this,t,this.clickFillSourceId,this.clickFillLayerId,.5):"line"===r&&e.prototype.SearchToLineHighlightBase.call(this,t,this.clickLineSourceId,this.clickLineLayerId)},t.prototype.clearHighlightMarker=function(){e.prototype.clearHighlightMarkerBase.call(this)},t.prototype.clearClickHighlight=function(){e.prototype.clearHighlightBase.call(this,[this.clickFillSourceId,this.clickLineSourceId])},t.prototype.clearSearchHighlight=function(){e.prototype.clearHighlightBase.call(this,[this.searchLineSourceId,this.searchFillSourceId])},t.prototype.info=function(t,r){e.prototype.popupBase.call(this,t,r)},t}(r("NyFr").CommonSearchService);t.AttributeSearch=n},HDVh:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Feature=void 0;var o=r("FTm/"),i=function(){function e(e){this.type="Feature",this.geometry={coordinates:[],type:""},this.id=o.Hat.hat(),this.properties={},this.properties.id=this.id}return e.prototype.setCoordinates=function(e){this.geometry.coordinates=e},e.prototype.getCoordinates=function(){return this.geometry.coordinates},e.prototype.setProperty=function(e,t){this.properties[e]=t},e}();t.Feature=i},NyFr:function(e,t,r){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.CommonSearchService=void 0;var n=r("Glxv"),a=r("o0BB"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.map=null,t.markerService=null,t.makers=[],t.curMarker=null,t.makerIds=0,t.popupService=null,t.renderService=null,t.highLightObj=null,t.option=null,t.url="",t.success=void 0,t}return i(t,e),t.prototype.setUrl=function(e){this.url=e},t.prototype.getUlr=function(){return this.url},t.prototype.initBase=function(e){this.makerIds=0,this.map=map.Container.get("map"),this.option=e},t.prototype.handlePromiseResult=function(e,t,r){t&&(this.success=t),"0"==e.code&&e.data?(this.datas=e.data,this.pageList=e.data.features,this.initPages(),this.firstPage()):this.resetData(),t&&t(this.datas)},t.prototype.handleGeoPage=function(e,t,r){for(var o=[],i=t;i<r;i++)o.push(e.features[i]);this.pageList=o,this.success&&this.success(e)},t.prototype.handleArcPage=function(e,t,r){for(var o=[],i=t;i<r;i++)o.push(e.features[i]);this.pageList=o,this.success&&this.success(e)},t.prototype.GeoJsonToArc=function(e,t){map.Factory.Utils("Terraformer",(function(r){return r.GeojsonToArc(e,t)}))},t.prototype.GeoGeometryToWkt=function(e){map.Factory.Utils("Terraformer",(function(t){return t.GeoGeometryToWkt(e)}))},t.prototype.showFeaturesBase=function(e){if(!(e.length<=0)){this.makerIds=0,this.makers.length>0&&this.clearBase();var t=this;e.forEach((function(e,r){t.showFeature(e,!1,r)}))}},t.prototype.showFeature=function(e,t,r){if(e&&e.geometry){this.makerIds++;var o=this,i="";i=t?"search-marker-highligth":"search-marker";var n=[0,0];"Point"===e.geometry.type?n=e.geometry.coordinates:map.Factory.Utils("TurfUtils",(function(t){n=t.turfCenterOfMass(e).geometry.coordinates}));var a=document.createElement("div");a.className=i+"-no-"+this.makerIds,null==this.markerService&&(this.markerService=map.Factory.MarkerManage());var s=this.makerIds;null!=e.properties.id?s=e.properties.id:null!=e.properties.objectid&&(s=e.properties.objectid,e.properties.id=e.properties.objectid);var c=this.markerService.add(s,n,{element:a});a.addEventListener("click",function(){o.clickOption(e,event)}.bind(this));var p={feature:e,makerIds:this.makerIds,marker:c,coordinates:n};this.curMarker=1==t?p:null,this.makers.push(p)}},t.prototype.clearBase=function(){this.clearHighlightMarkerBase(),this.clearLineHighlightBase(),this.makers.length>0&&(this.makers.forEach((function(e){e.marker.remove()})),this.makers=[],this.makerIds=0),this.popupService&&this.popupService.removeAll()},t.prototype.clickOption=function(e,t){this.highlightMarkerBase(e),this.popupBase(e,{offset:[0,-15]},t)},t.prototype.localByBoundsBase=function(e){var t=this;e.length>0&&void 0===e.type?map.Factory.Utils("GeojsonUtils",(function(r){var o=r.getPointBoundingBox(e),i={xmin:o[0],ymin:o[1],xmax:o[2],ymax:o[3]};t.map.flyTo(i)})):map.Factory.Utils("GeojsonUtils",(function(r){var o=r.getGeojsonBoundingBox(e),i={xmin:o[0],ymin:o[1],xmax:o[2],ymax:o[3]};t.map.flyTo(i)}))},t.prototype.localByCenterBase=function(e,t){var r={center:e};t&&map.Factory.copy(t,r,!0),this.map.easeTo(r)},t.prototype.highlightMarkerBase=function(e){if(e){if(this.curMarker){if(this.curMarker.feature.properties.id===e.properties.id)return;this.clearHighlightMarkerBase()}var t=null;if(this.makers.length>0)for(var r=0;r<this.makers.length;r++)if(this.makers[r].feature.properties.id===e.properties.id){t=this.makers[r];break}t?(this.updateMarkerState(t.marker,t.makerIds,!0),this.curMarker=t):this.showFeature(e,!0,this.makerIds)}},t.prototype.lineHighlightBase=function(e,t){var r=this;if(e){null==this.renderService&&(this.renderService=map.Factory.Render()),this.renderService.highlight(e,t);var o=[0,0];map.Factory.Utils("TurfUtils",(function(t){o=t.turfCenterOfMass(e).geometry.coordinates;var i={feature:e,coordinates:o};r.highLightObj=i}))}},t.prototype.SearchToFillHighlightBase=function(e,t,r,o){var i=this.map.getMap().getSource(t),n=[];e.forEach((function(e){var t=new a.Polygon([e]);n.push(t)}));var s={type:"FeatureCollection",features:n};if(i)i.setData(s);else{this.map.getMap().addSource(t,{data:s,type:"geojson"});var c={id:r,type:"fill",paint:{"fill-color":"#df1711","fill-outline-color":"#df1711","fill-opacity":o||.2},source:t};this.map.getMap().addLayer(c)}},t.prototype.SearchToLineHighlightBase=function(e,t,r){var o=this.map.getMap().getSource(t),i={type:"FeatureCollection",features:e};if(o)o.setData(i);else{this.map.getMap().addSource(t,{data:i,type:"geojson"});var n={id:r,type:"line",source:t,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#df1711","line-width":10}};this.map.getMap().addLayer(n)}},t.prototype.clearHighlightBase=function(e){var t=this;e.forEach((function(e){var r=t.map.getMap().getSource(e);r&&r.setData({type:"FeatureCollection",features:[]})}))},t.prototype.updateMarkerState=function(e,t,r){var o=e.getElement();if(o){var i=r?"search-marker-highligth":"search-marker";o.className=i+"-no-"+t}},t.prototype.clearHighlightMarkerBase=function(){this.curMarker&&(this.updateMarkerState(this.curMarker.marker,this.curMarker.makerIds,!1),this.curMarker=null)},t.prototype.clearLineHighlightBase=function(){this.highLightObj&&(null==this.renderService&&(this.renderService=map.Factory.Render()),this.renderService.clearHighlight(null))},t.prototype.popupBase=function(e,t,r){var o=this,i=this.option&&this.option.infoTemplateId?this.option.infoTemplateId:"";if(""!=i){var n=document.getElementById(i);if(n){var a=document.createElement("div");a.style.zIndex="100",a.style.width=this.option&&this.option.infoWindowWidth?this.option.infoWindowWidth:"unset",a.style.height=this.option&&this.option.infoWindowHeight?this.option.infoWindowHeight:"280px",a.style.overflow=this.option&&this.option.infoWindowOverflow?this.option.infoWindowOverflow:"scroll";for(var s=0;s<n.childNodes.length;s++){var c=n.childNodes[s].cloneNode(!0);a.appendChild(c)}if(e.properties){var p=e.properties;if(a.childNodes[0]){var l=a.childNodes[0];for(s=0;s<l.childNodes.length;s++){var h=l.childNodes[s];if(h.childNodes[1]&&1==h.childNodes[1].nodeType)for(var u=h.childNodes[1],d=0;d<u.childNodes.length;d++)if(3==u.childNodes[d].nodeType){var f=u.childNodes[d],y=f.nodeValue,g=y.replace("~[","").replace("]","");!0===p.hasOwnProperty(g)&&null!=p[g]?"number"==typeof p[g]?f.nodeValue=f.nodeValue.replace(y,parseFloat(p[g])):f.nodeValue=f.nodeValue.replace(y,p[g]):f.nodeValue=f.nodeValue.replace(y,"æ— ")}}}}null==this.popupService&&(this.popupService=map.Factory.PopupManage()),this.popupService.removeAll();var m={offset:[0,-15],closeButton:!0,closeOnClick:!1};if(map.Factory.copy(t||{},m,!0),this.curMarker)this.popupService.addDomPopup(e.properties.id,this.curMarker.coordinates,a,m);else{var v=[0,0];"Point"===e.geometry.type?(v=e.geometry.coordinates,this.popupService.addDomPopup(e.properties.id,v,a,m)):map.Factory.Utils("TurfUtils",(function(t){v=t.turfCenterOfMass(e).geometry.coordinates,o.popupService.addDomPopup(e.properties.id,v,a,m)}))}this.option&&this.option.clickEvent&&this.option.clickEvent(e,r)}}},t.prototype.resetRenderService=function(){this.renderService&&(this.renderService.inited=!1)},t}(n.PageService);t.CommonSearchService=s},Ozvm:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),r("4mlF"),i(r("HCmN"),t),i(r("EoQN"),t),i(r("objX"),t);var n=r("HCmN"),a=r("objX"),s=r("EoQN");map.Container.set("AttributeSearch",new n.AttributeSearch),map.Container.set("KeySearch",new a.KeySearch),map.Container.set("SpatialSearch",new s.SpatialSearch)},iHm6:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;var o=function(){function e(){}return e.geojsonTypes={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},e.meta={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},e.LAT_MIN=-90,e.LAT_RENDERED_MIN=-85,e.LAT_MAX=90,e.LAT_RENDERED_MAX=85,e.LNG_MIN=-270,e.LNG_MAX=270,e}();t.Constants=o},o0BB:function(e,t,r){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.Polygon=void 0;var n=r("HDVh"),a=r("iHm6"),s=function(e){function t(t){var r=e.call(this,t)||this;return r.geometry.type=a.Constants.geojsonTypes.POLYGON,r.geometry.coordinates=t,r}return i(t,e),t.prototype.isValid=function(){return 0!==this.geometry.coordinates.length&&this.geometry.coordinates.every((function(e){return e.length>2}))},t.prototype.incomingCoords=function(e){this.geometry.coordinates=e.map((function(e){return e.slice(0,-1)}))},t.prototype.setCoordinates=function(e){this.geometry.coordinates=e},t.prototype.addCoordinate=function(e,t,r){var o=e.split(".").map((function(e){return parseInt(e,10)}));this.geometry.coordinates[o[0]].splice(o[1],0,[t,r])},t.prototype.removeCoordinate=function(e){var t=e.split(".").map((function(e){return parseInt(e,10)})),r=this.geometry.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.geometry.coordinates.splice(t[0],1))},t.prototype.getCoordinate=function(e){var t=e.split(".").map((function(e){return parseInt(e,10)}));return this.geometry.coordinates[t[0]][t[1]]},t.prototype.getCoordinates=function(){return this.geometry.coordinates.map((function(e){return e.concat([e[0]])}))},t.prototype.updateCoordinate=function(e,t,r){var o=e.split("."),i=parseInt(o[0],10),n=parseInt(o[1],10);void 0===this.geometry.coordinates[i]&&(this.geometry.coordinates[i]=[]),this.geometry.coordinates[i][n]=[t,r]},t}(n.Feature);t.Polygon=s},objX:function(e,t,r){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.KeySearch=void 0;var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="",t.params={},t}return i(t,e),t.prototype.init=function(t,r){e.prototype.initBase.call(this,r),this.type=t},t.prototype.search=function(e,t,r){var o=this;this.params=e,this.params.inExtent&&(this.params.extent=this.params.extent?this.params.extent:this.map.getExtent());var i=map.Factory.deepCopy(e);map.Factory.SearchData("KeyData",(function(e){e.search(o.type,i,(function(e){o.handlePromiseResult(e,t,r)}),(function(e){r&&r()}))}))},t.prototype.handlePage=function(e,t,r){switch(this.type){case"arcgis":this.handleArcPage(e,t,r);break;case"geoserver":this.handleGeoPage(e,t,r)}},t.prototype.showFeatures=function(){this.pageList.length>0&&e.prototype.showFeaturesBase.call(this,this.pageList)},t.prototype.clear=function(){e.prototype.clearBase.call(this)},t.prototype.localByBounds=function(){if(this.pageList&&1===this.pageList.length){if(!this.pageList[0].geometry)return;e.prototype.localByBoundsBase.call(this,this.pageList[0])}else if(this.pageList&&this.pageList.length>1){var t=[];this.pageList.forEach((function(e){e.geometry&&("Point"===e.geometry.type?t.push(e.geometry.coordinates):map.Factory.Utils("TurfUtils",(function(r){t.push(r.turfCenterOfMass(e).geometry.coordinates)})))})),t.length>0&&e.prototype.localByBoundsBase.call(this,t)}},t.prototype.localByCenter=function(t,r){var o=this;"Point"===t.geometry.type?e.prototype.localByCenterBase.call(this,t.geometry.coordinates,r):map.Factory.Utils("TurfUtils",(function(i){e.prototype.localByCenterBase.call(o,i.turfCenterOfMass(t).geometry.coordinates,r)}))},t.prototype.highlight=function(t){e.prototype.highlightMarkerBase.call(this,t)},t.prototype.clearHighlightMarker=function(){e.prototype.clearHighlightMarkerBase.call(this)},t.prototype.info=function(t,r){e.prototype.popupBase.call(this,t,r)},t}(r("NyFr").CommonSearchService);t.KeySearch=n}})}));